<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Form and informations</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    
    .flex-container {
      display: flex;
      flex-direction: row;
      justify-content: space-between; 
      gap: 20px; 
      max-width: 1200px;
      width: 90%;
      margin: 0 auto;
      padding: 20px;
      background-color: #FAD961;
      background-image: linear-gradient(90deg, #F76B1C 0%, #FAD961 100%);
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      overflow-x: auto;
    }

    /* Left Container */
    .form-container {
      width: 48%; 
    }

    /* Right Container */
    .table-container {
       width: 48%;   
      /* overflow-x: auto; */
    }

    
    .form-group {
      margin-bottom: 15px;

      /* display: flex;
  flex-direction: column; */
    }

    /* label {
  margin-bottom: 5px;
} */

/* input, select, textarea, button {
  padding: 8px;
  width: 100%;
  box-sizing: border-box;
} */

/* button {
  margin-top: 10px;
  padding: 10px 15px;
  background-color: #28a745;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
} */

/* button:hover {
  background-color: #218838;
} */


    


    .required::after {
      content: "*";
      color: red;
      margin-left: 5px;
    }

    .error-message {
      color: red;
      font-size: 12px;
      margin-top: 5px;
      
    }

    /* Table styling */
    table {
      width: 100%;
      border-collapse: collapse;
    }

    table th, table td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: left;
    }

    table th {
      background-color: #F76B1C;
      color: white;
    }

    .action-buttons button {
      margin-right: 5px;
      padding: 8px 12px;
      border-radius: 5px;
      border: none;
      cursor: pointer;
      font-size: 14px;
    }

    .edit-btn {
      background-color: #28a745;
      color: white;
    }

    .edit-btn:hover {
      background-color: #218838;
    }

    .delete-btn {
      background-color: #dc3545;
      color: white;
    }

    .delete-btn:hover {
      background-color: #c82333;
    }

    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 10px 20px;
      background-color: #28a745;
      color: white;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      display: none;
      z-index: 1000;
    }


    @media (max-width:768px){
      .flex-container{
        flex-direction: column;
      }
      .form-container, .table-container{
        width: 100%;
      }
    }

    /* .flex-container{
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap:20px;
      padding:20px;
    }
    @media screen and (max-width:767px){
      .flex-container{
        grid-template-columns: 1fr;
      }
    } */


    .modal {
  display: none;
  position: fixed;
  z-index: 1;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgb(0,0,0);
  background-color: rgba(0,0,0,0.4);
}

.modal-content {
  background-color: #fefefe;
  margin: 15% auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
}




  </style>
</head>
<body>

<!-- Parent container  -->
<div class="flex-container">

  <!-- Left Container -->
  <div class="form-container">
    <h1>Registration Form</h1>
    <form id="registrationForm">
      <!-- Full Name -->
      <div  class="form-group">
        <label for="fullname" class="required">Fullname:</label>
        <input  type="text" id="fullname" name="fullname" required>
        <span  id="fullname_error" class="error-message"></span>
      </div>

      <!-- Phone -->
      <div class="form-group">
        <label for="phone" class="required">Phone:</label>
        <input type="text" id="phone" name="phone" required>
        <span id="phone_error" class="error-message"></span>
      </div>

      <!-- Email -->
      <div class="form-group">
        <label for="email" class="required">Email:</label>
        <input type="email" id="email" name="email" required>
        <span id="email_error" class="error-message"></span>
      </div>

      <!-- Date of Birth -->
      <div class="form-group">
        <label for="dob" >Date of Birth:</label>
        <input type="date" id="dob" name="dob" required>
        <span id="dob_error" class="error-message"></span>
      </div>

      <!-- Gender -->
      <div class="form-group">
        <label for="gender" class="required">Gender:</label>
        <input type="radio" id="male" name="gender" value="male" />
        <label for="male">Male</label>
        <input type="radio" id="female" name="gender" value="female" />
        <label for="female">Female</label>
        <input type="radio" id="other" name="gender" value="other" />
        <label for="other">Other</label>
        <span id="gender_error" class="error-message"></span>
      </div>

      <!-- Experience -->
      <div class="form-group">
        <label for="experience" >Experience:</label>
        <input type="radio" id="beginner" name="experience" value="beginner" />
        <label for="beginner">Beginner</label>
        <input type="radio" id="intermediate" name="experience" value="intermediate" />
        <label for="intermediate">Intermediate</label>
        <input type="radio" id="expert" name="experience" value="expert" />
        <label for="expert">Expert</label>
        <span id="experience_error" class="error-message"></span>
      </div>

      <!-- Preferred Medium -->
      <div class="form-group">
        <label for="preferredMedium" >Preferred Medium:</label>
        <select id="preferredMedium" name="preferredMedium">
          <option value="Oil">Oil</option>
          <option value="Acrylic">Acrylic</option>
          <option value="Watercolor">Watercolor</option>
          <option value="Pastel">Pastel</option>
        </select>
        <span id="preferredMedium_error" class="error-message"></span>
      </div>

      <!-- Preferred Date -->
      <div class="form-group">
        <label for="preferredDate" >Preferred Date:</label>
        <select id="preferredDate" name="preferredDate" size="2">
          <option value="FEB-1">FEB-1</option>
          <option value="FEB-2">FEB-2</option>
          <option value="FEB-3">FEB-3</option>
          <option value="FEB-4">FEB-4</option>
          <option value="FEB-5">FEB-5</option>
        </select>
        <span id="preferredDate_error" class="error-message"></span>
      </div>

      <!-- File Upload
      <div class="form-group">
        <label for="file">Upload File:</label>
        <input type="file" id="file" name="filename" />
        <span id="file_error" class="error-message"></span>
      </div> -->

      <!-- Age -->
      <div class="form-group">
        <label for="age" class="required">Age:</label>
        <input type="number" id="age" name="age" required>
        <span id="age_error" class="error-message"></span>
      </div>

      <!-- Address -->
      <div class="form-group">
        <label for="address" >Address:</label>
        <textarea id="address" name="address" rows="4" required></textarea>
        <span id="address_error" class="error-message"></span>
      </div>

      <!-- Country, State, City Dropdown -->
      <div class="form-group">
        <label for="country"class="required">Country:</label>
        <select id="country" name="country" onchange="updateStates()" required>
          <option value="">Select Country</option>
          <option value="India">India</option>
          <option value="USA">USA</option>
          <option value="UK">UK</option>
        </select>
        <span id="country_error" class="error-message"></span>
      </div>
      
      <div class="form-group">
        <label for="state"class="required">State:</label>
        <select id="state" name="state" onchange="updateCities()" required>
          <option value="">Select State</option>
        </select>
        <span id="state_error" class="error-message"></span>
      </div>
      
      <div class="form-group">
        <label for="city" class="required">City:</label>
        <select id="city" name="city" required>
          <option value="">Select City</option>
        </select>
        <span id="city_error" class="error-message"></span>
      </div>

      <!-- Submit Button -->
      <button type="button" id="submitBtn" onclick="submitForm()">Submit</button>
    </form>
  </div>

  <div id="confirmDeleteModal" class="modal">
    <div class="modal-content">
      <p>Type "delete" to confirm you want to delete this record:</p>
      <input type="text" id="deleteConfirmationInput" />
      <button onclick="confirmDelete()">Confirm</button>
      <button onclick="cancelDelete()">Cancel</button>
    </div>
  </div>
  

  <!-- Right Container-->
  <div class="table-container">
    <h2>Submitted Information</h2>
    <table id="data-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Phone</th>
          <th>Email</th>
          <th>Gender</th>
          <th>Country</th>
          <!-- <th>State</th> -->
          <!-- <th>City</th> -->
          <th>Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
  <div id="notification" class="notification"></div>

</div>

<script>
    let currentRow = null; 


const data = {
  "India": {
    "states": {
      "Delhi": ["New Delhi", "Old Delhi"],
      "Kolkata": ["Kolkata", "Howrah"],
      "Mumbai": ["Mumbai", "Thane"]
    }
  },
  "USA": {
    "states": {
      "California": ["Los Angeles", "San Francisco"],
      "Texas": ["Houston", "Austin"],
      "New York": ["New York City", "Buffalo"]
    }
  },
  "UK": {
    "states": {
      "England": ["London", "Manchester"],
      "Scotland": ["Edinburgh", "Glasgow"]
    }
  }
};


// 
function updateStates() {
  const country = document.getElementById("country").value;
  const stateSelect = document.getElementById("state");
  const citySelect = document.getElementById("city");

  // Clear previous state and city options
  stateSelect.innerHTML = '<option value="">Select State</option>';
  citySelect.innerHTML = '<option value="">Select City</option>';

  if (country && data[country]) {
    const states = data[country].states;

    // Populate states based on selected country
    for (const state in states) {
      const option = document.createElement("option");
      option.value = state;
      option.textContent = state;
      stateSelect.appendChild(option);
    }
  }
}


function updateCities() {
  const country = document.getElementById("country").value;
  const state = document.getElementById("state").value;
  const citySelect = document.getElementById("city");

  // Clear previous city options
  citySelect.innerHTML = '<option value="">Select City</option>';

  if (country && state && data[country] && data[country].states[state]) {
    const cities = data[country].states[state];

    // Populate cities based on selected state
    cities.forEach(city => {
      const option = document.createElement("option");
      option.value = city;
      option.textContent = city;
      citySelect.appendChild(option);
    });
  }
}


function saveData(data) {
  let storedData = JSON.parse(localStorage.getItem('formData')) || [];

  storedData.push(data);
  localStorage.setItem('formData', JSON.stringify(storedData));
}


function loadSavedData() {
  const storedData = JSON.parse(localStorage.getItem('formData')) || [];
  const tableBody = document.querySelector("#data-table tbody");
  tableBody.innerHTML = ''; 

  storedData.forEach((data, index) => {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${data.fullname}</td>
      <td>${data.phone}</td>
      <td>${data.email}</td>
      <td>${data.gender}</td>
      <td>${data.country}</td>
  
      <td class="action-buttons">
        <button class="edit-btn" onclick="editRow(${index})">Edit</button>
        <button class="delete-btn" onclick="deleteRow(${index})">Delete</button>
      </td>
    `;
    tableBody.appendChild(row);
  });
}


// function editRow(index) {
//   document.getElementById('submitBtn').textContent = 'Update';
//   const storedData = JSON.parse(localStorage.getItem('formData')) || [];
//   const data = storedData[index];
//   document.getElementById("fullname").value = data.fullname;
//   document.getElementById("phone").value = data.phone;
//   // document.getElementById("preferredMedium").value = data.preferredMedium;
//   // document.getElementById("preferredDate").value = data.preferredDate;
//   document.getElementById("email").value = data.email;
//   // document.getElementById("address").value = data.address;
//   document.getElementById("age").value = data.age;
//   //   document.getElementById("gender").value = data.gender;
//   document.getElementById("country").value = data.country;
  
//   updateStates();
//   document.getElementById("state").value = data.state;
//   updateCities();
//   document.getElementById("city").value = data.city;

//   // document.getElementById("dob").value = data.dob;
//   const gender = data.gender;
//   const experience= data.experience
//   if (experience) {
//     document.querySelector(`input[name="experience"][value="${experience}"]`).checked = true;
//   }
//   console.log(gender)
//   if (gender) {
//     document.querySelector(`input[name="gender"][value="${gender}"]`).checked = true;
//   }
//   currentRow = index;
// }

// Modified submitForm function
function submitForm() {
  const form = document.getElementById("registrationForm");

  if (!validateForm()) {
    return; 
  }

  const formData = {
    fullname: form.fullname.value,
    phone: form.phone.value,
    email: form.email.value,
    age: form.age.value,
    dob: form.dob.value,
    gender: form.gender.value,
    experience: form.experience.value,
    preferredMedium: form.preferredMedium.value,
    preferredDate: form.preferredDate.value,
    address: form.address.value,
    country: form.country.value,
    state: form.state.value,
    city: form.city.value,
  };

  let storedData = JSON.parse(localStorage.getItem('formData')) || [];
  const existingData = storedData.find(data => data.email === formData.email || data.phone === formData.phone);

  if (existingData && currentRow === null) {
    showNotification('The data with this email or phone already exists.');
    return;
  }

  if (document.getElementById('submitBtn').textContent === 'Update') {
    storedData[currentRow] = formData;
    showNotification('Form updated successfully');
    currentRow = null;
  } else {
    if (!existingData) {
      storedData.push(formData);
      showNotification('Form submitted successfully');
    }
  }

  localStorage.setItem('formData', JSON.stringify(storedData));
  resetForm();
  loadSavedData();
}

// Modify editRow to set currentRow and button text
function editRow(index) {
  document.getElementById('submitBtn').textContent = 'Update';
  const storedData = JSON.parse(localStorage.getItem('formData')) || [];
  const data = storedData[index];
  
  document.getElementById("fullname").value = data.fullname;
  document.getElementById("phone").value = data.phone;
  document.getElementById("email").value = data.email;
  document.getElementById("age").value = data.age;
  document.getElementById("country").value = data.country;
  updateStates();
  document.getElementById("state").value = data.state;
  updateCities();
  document.getElementById("city").value = data.city;

  const gender = data.gender;
  if (gender) {
    document.querySelector(`input[name="gender"][value="${gender}"]`).checked = true;
  }

  currentRow = index;
}


// function deleteRow(index) {
//   let storedData = JSON.parse(localStorage.getItem('formData')) || [];
//   storedData.splice(index, 1);
//   localStorage.setItem('formData', JSON.stringify(storedData));
//   loadSavedData();
// }

// function deleteRow(index) {
//   if (confirm("Are you sure you want to delete this record?")) {
//     let storedData = JSON.parse(localStorage.getItem('formData')) || [];
//     storedData.splice(index, 1);
//     localStorage.setItem('formData', JSON.stringify(storedData));
//     loadSavedData();
//     showNotification('Data deleted successfully');
//   }
// }

let deleteIndex;

function deleteRow(index) {
  deleteIndex = index;
  document.getElementById('confirmDeleteModal').style.display = 'block';
}

function confirmDelete() {
  const userInput = document.getElementById('deleteConfirmationInput').value;
  if (userInput.toLowerCase() === 'delete') {
    let storedData = JSON.parse(localStorage.getItem('formData')) || [];
    storedData.splice(deleteIndex, 1);
    localStorage.setItem('formData', JSON.stringify(storedData));
    loadSavedData();
    showNotification('Data deleted successfully');
  } else {
    alert('Action canceled. You did not type "delete".');
  }
  closeModal();
}

function cancelDelete() {
  closeModal();
}

function closeModal() {
  document.getElementById('confirmDeleteModal').style.display = 'none';
  document.getElementById('deleteConfirmationInput').value = '';
}


 
 function showNotification(message) {
    const notification = document.getElementById('notification');
    notification.textContent = message;
    notification.style.display = 'block';
    setTimeout(() => {
      notification.style.display = 'none';
    }, 3000);
  }

// Function to submit the form
// function submitForm() {
//   const form = document.getElementById("registrationForm");

//         // Check if the form fields are valid
//     if (!validateForm()) {
//         return; // Do not submit if the form is invalid
//         }
 

//   const formData = {
//     fullname: form.fullname.value,
//     phone: form.phone.value,
//     email: form.email.value,
//     age: form.age.value,
//     dob: form.dob.value,
//     gender: form.gender.value,
//     experience:form.experience.value,
//     preferredMedium: form.preferredMedium.value,
//     preferredDate: form.preferredDate.value,
//     address: form.address.value,
//     country: form.country.value,
//     state: form.state.value,
//     city: form.city.value,
//   };

//   if (currentRow !== null) {
//     let storedData = JSON.parse(localStorage.getItem('formData')) || [];
//     storedData[currentRow] = formData;
//     localStorage.setItem('formData', JSON.stringify(storedData));
//     currentRow = null;
//   } else {
//     saveData(formData);
//   }

//   resetForm();
//   loadSavedData(); // Refresh table
// }

 
//  function submitForm() {
//     const form = document.getElementById("registrationForm");

    
//     if (!validateForm()) {
//       return; 
//     }

//     const formData = {
//       fullname: form.fullname.value,
//       phone: form.phone.value,
//       email: form.email.value,
//       age: form.age.value,
//       dob: form.dob.value,
//       gender: form.gender.value,
//       experience: form.experience.value,
//       preferredMedium: form.preferredMedium.value,
//       preferredDate: form.preferredDate.value,
//       address: form.address.value,
//       country: form.country.value,
//       state: form.state.value,
//       city: form.city.value,
//     };

//     // let storedData = JSON.parse(localStorage.getItem('formData')) || [];

//     // let existingData = storedData.find(data => data.email === formData.email || data.phone === formData.phone );
//     // if(existingData) {
//     //   showNotification('the data with this email and phone already exists.');
//     //   return;
//     // }

//     if (currentRow !== null) {
//       let storedData = JSON.parse(localStorage.getItem('formData')) || [];
//       storedData[currentRow] = formData;
//       localStorage.setItem('formData', JSON.stringify(storedData));
//       currentRow = null;
//       showNotification('Form updated successfully');
//     } else {
//       saveData(formData);
//       showNotification('Form submitted successfully');
//     }

//     resetForm();
//     loadSavedData(); 
//   }


function resetForm() {
  document.getElementById("registrationForm").reset();
  document.getElementById("submitBtn").innerText = "Submit";
}

document.getElementById('fullname').addEventListener('blur', () => {
        const fullname = document.getElementById("fullname").value;
            const nameErr = document.getElementById("fullname_error");
            if (fullname === "" || /\d/.test(fullname)) {
              nameErr.textContent = "Please enter your name properly.";
              return false;
            }
            nameErr.textContent = "";
            return true;
    });



    document.getElementById('phone').addEventListener('input', () => {
        const phone = document.getElementById("phone").value;
            const phoneErr = document.getElementById("phone_error");
            const phonePattern = /^\d{10}$/;
            if (phone === "" || !phone.match(phonePattern)) {
              phoneErr.textContent = "Please enter a valid 10-digit number.";
              return false;
            }
            phoneErr.textContent = "";
            return true;
    });
    document.getElementById('email').addEventListener('input', () => {
        const email = document.getElementById("email").value;
            const emailErr = document.getElementById("email_error");
            if (email === "" || !email.includes("@") || !email.includes(".")) {
              emailErr.textContent = "Please enter a valid email address.";
              return false;
            }
            emailErr.textContent = "";
            return true;
    });
    document.getElementById('age').addEventListener('input', () => {
        const age = document.getElementById("age").value;
            const ageErr = document.getElementById("age_error");
            if (age === "" || age < 1 || age > 120) {
              ageErr.textContent = "Please enter a valid age.";
              return false;
            }
            ageErr.textContent = "";
            return true;
    });
    // document.getElementById('address').addEventListener('input', () => {
    //     const address = document.getElementById("address").value;
    //         const addrErr = document.getElementById("address_error");
    //         if (address === "") {
    //           addrErr.textContent = "Please fill this required field.";
    //           return false;
    //         }
    //         addrErr.textContent = "";
    //         return true;
    // });
    document.getElementById('country').addEventListener('change', () => {
        const country = document.getElementById("country").value;
            const countryErr = document.getElementById("country_error");
            if (country === "") {
              countryErr.textContent = "Please fill this required field.";
              return false;
            }
            countryErr.textContent = ""
    });
    document.getElementById('state').addEventListener('change', () => {
        const state = document.getElementById("state").value;
            const stateErr = document.getElementById("state_error");
            if (state === "") {
              stateErr.textContent = "Please fill this required field.";
              return false;
            }
            stateErr.textContent = "";
    });
    document.getElementById('city').addEventListener('change', () => {
         const city = document.getElementById("city").value;
            const cityErr = document.getElementById("city_error");
            if (city === "") {
              cityErr.textContent = "Please fill this required field.";}
    });
   


    function validateForm() {
        let isValid = true;

        // Validate Fullname
        const fullname = document.getElementById("fullname").value;
        const fullnameErr = document.getElementById("fullname_error");
        if (fullname === "" || /\d/.test(fullname)) {
            fullnameErr.textContent = "Please enter a valid name.";
            isValid = false;
        } else {
            fullnameErr.textContent = "";
        }

        // Validate Phone
        const phone = document.getElementById("phone").value;
        const phoneErr = document.getElementById("phone_error");
        const phonePattern = /^\d{10}$/;
        if (phone === "" || !phone.match(phonePattern)) {
            phoneErr.textContent = "Please enter a valid 10-digit phone number.";
            isValid = false;
        } else {
            phoneErr.textContent = "";
        }

        // Validate Email
        const email = document.getElementById("email").value;
        const emailErr = document.getElementById("email_error");
        if (email === "" || !email.includes("@") || !email.includes(".")) {
            emailErr.textContent = "Please enter a valid email address.";
            isValid = false;
        } else {
            emailErr.textContent = "";
        }

        // Validate Age
        const age = document.getElementById("age").value;
        const ageErr = document.getElementById("age_error");
        if (age === "" || age < 1 || age > 120) {
            ageErr.textContent = "Please enter a valid age.";
            isValid = false;
        } else {
            ageErr.textContent = "";
        }

        // Validate Address
        // const address = document.getElementById("address").value;
        // const addrErr = document.getElementById("address_error");
        // if (address === "") {
        //     addrErr.textContent = "Please fill this required field.";
        //     isValid = false;
        // } else {
        //     addrErr.textContent = "";
        // }

        // Validate Country
        const country = document.getElementById("country").value;
        const countryErr = document.getElementById("country_error");
        if (country === "") {
            countryErr.textContent = "Please select a country.";
            isValid = false;
        } else {
            countryErr.textContent = "";
        }

        // Validate State
        const state = document.getElementById("state").value;
        const stateErr = document.getElementById("state_error");
        if (state === "") {
            stateErr.textContent = "Please select a state.";
            isValid = false;
        } else {
            stateErr.textContent = "";
        }

        // Validate City
        const city = document.getElementById("city").value;
        const cityErr = document.getElementById("city_error");
        if (city === "") {
            cityErr.textContent = "Please select a city.";
            isValid = false;
        } else {
            cityErr.textContent = "";
        }

        return isValid;
    }

   



window.onload = function() {
  loadSavedData();
};

</script>

</body>
</html>